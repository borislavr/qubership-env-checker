{{- if or (and .Values.ENVCHECKER_GIT_USERNAME .Values.ENVCHECKER_GIT_TOKEN .Values.ENVCHECKER_GIT_DOMAIN) (and .Values.git.username .Values.git.token) }}
apiVersion: v1
kind: Secret
metadata:
  name: env-checker-git-secret
  labels:
    name: '{{ .Values.SERVICE_NAME }}'
    application: '{{ .Values.APPLICATION_NAME }}'
    app.kubernetes.io/name: '{{ .Values.SERVICE_NAME }}'
    app.kubernetes.io/part-of: '{{ .Values.APPLICATION_NAME }}'
    app.kubernetes.io/managed-by: '{{ .Values.MANAGED_BY }}'
stringData:
  GIT_USERNAME: "{{ .Values.git.username | default "" }}"
  GIT_TOKEN: "{{ .Values.git.token | default "" }}"
  GIT_REPOSITORY_URL: "{{ .Values.git.repositoryUrl | default "" }}"
  GIT_TARGET_PATH: "{{ .Values.git.targetPath | default "" }}"
  GIT_SPARSE_PATH: "{{ .Values.git.sparsePath | default "" }}"
  GIT_BRANCH: "{{ .Values.git.branch | default "main" }}"
  # Legacy variables for backward compatibility with old git_helper.sh
  ENVCHECKER_GIT_USERNAME: "{{ .Values.ENVCHECKER_GIT_USERNAME | default "" }}"
  ENVCHECKER_GIT_TOKEN: "{{ .Values.ENVCHECKER_GIT_TOKEN | default "" }}"
  ENVCHECKER_GIT_DOMAIN: "{{ .Values.ENVCHECKER_GIT_DOMAIN | default "" }}"
{{- end }}
